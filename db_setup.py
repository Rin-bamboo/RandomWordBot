# -*- coding: Shift-JIS -*-
import mysql.connector
import config

db_name=config.DB
user_name=config.USER_NAME
host_name=config.HOST
user_password=config.PASS

#=======================ログ出力設定============================
from log_setting import getLogger
logger = getLogger(__name__)

# MySQL接続情報
db_config = {
    "host": host_name,  # ホスト名
    "user": user_name,       # ユーザ名
    "password": user_password,  # パスワード
    "database": db_name  # データベース名
}

class DbQuery():
    def quryexcute(self,query,values):
        try:
            # MySQLデータベースに接続
            connection = mysql.connector.connect(**db_config)

            if connection.is_connected():
                # バージョン情報を取得
                cursor = connection.cursor()
                logger.info("Connected to MySQL Server")


                #query="INSERT INTO botseqtable(guild_id,channel_id) VALUES(%s,%s)"
                #values = (1076845818407026758,1076849137007472690)
                cmpleate_query = cursor.execute(query,values)
                logger.info(f"クエリ情報：{query}")
                logger.info(f"データ情報：{values}")

                query_value = cursor.fetchall()
                connection.commit();

                return query_value

        except mysql.connector.Error as e:
            print("Error:", e)
            logger.error(e)
            connection.rollback();
            # エラーが発生した場合の処理をここに追加
            # 例: エラーログの出力、エラーメッセージの通知、別のアクションの実行など

        finally:
            # 接続をクローズ
            if connection is not None and connection.is_connected():
                cursor.close()
                connection.close()
                logger.info("Connection closed")
